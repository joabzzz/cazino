<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Cazino</title>
        <meta
            name="description"
            content="Prediction markets for family gatherings"
        />
        <meta name="theme-color" content="#000000" />

        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="favicon.ico" />

        <!-- PWA Manifest -->
        <link rel="manifest" href="manifest.json" />

        <!-- iOS PWA Support -->
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent"
        />
        <meta name="apple-mobile-web-app-title" content="Cazino" />
        <link rel="apple-touch-icon" href="apple-touch-icon.png" />

        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <!-- Landing Screen -->
        <div id="landing-screen" class="screen active">
            <div class="container">
                <img src="logo.png" alt="Cazino" class="logo-img" />
                <h1 class="logo">CAZINO</h1>
                <p class="tagline">Prediction markets for family gatherings</p>

                <div class="action-group">
                    <button id="create-market-btn" class="btn btn-primary">
                        Create Market
                    </button>
                    <button id="join-market-btn" class="btn btn-secondary">
                        Join Market
                    </button>
                </div>
            </div>
        </div>

        <!-- Create Market Screen -->
        <div id="create-market-screen" class="screen">
            <div class="container">
                <h2>Create Market</h2>

                <form id="create-market-form">
                    <div class="form-group">
                        <label for="admin-name">Your Username</label>
                        <input
                            type="text"
                            id="admin-name"
                            placeholder="e.g., alice, dad, mom2"
                            required
                            pattern="[a-zA-Z0-9_]+"
                        />
                        <small
                            style="
                                color: var(--gray-500);
                                margin-top: 4px;
                                display: block;
                            "
                            >Letters, numbers, and underscores only</small
                        >
                    </div>

                    <div class="form-group">
                        <label for="market-name">Market Name</label>
                        <input
                            type="text"
                            id="market-name"
                            placeholder="e.g., Thanksgiving 2024"
                            required
                        />
                    </div>

                    <div class="form-group">
                        <label for="duration">Duration (hours)</label>
                        <input
                            type="number"
                            id="duration"
                            value="24"
                            min="1"
                            max="168"
                            required
                        />
                    </div>

                    <div class="form-group">
                        <label for="starting-balance"
                            >Starting Balance ($)</label
                        >
                        <input
                            type="number"
                            id="starting-balance"
                            value="1000"
                            min="100"
                            step="100"
                            required
                        />
                    </div>

                    <div class="button-group">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            onclick="showScreen('landing-screen')"
                        >
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Create
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Join Market Screen -->
        <div id="join-market-screen" class="screen">
            <div class="container">
                <h2>Join Market</h2>

                <!-- Recent Markets Section -->
                <div
                    id="recent-markets"
                    class="recent-markets-section"
                    style="display: none"
                >
                    <h3>Recent Markets</h3>
                    <div
                        id="recent-markets-list"
                        class="recent-markets-list"
                    ></div>
                    <div class="divider-text">or join a new market</div>
                </div>

                <form id="join-market-form">
                    <div class="form-group">
                        <label for="invite-code">Invite Code</label>
                        <input
                            type="text"
                            id="invite-code"
                            placeholder="ABC123"
                            required
                            maxlength="6"
                            style="text-transform: uppercase"
                        />
                    </div>

                    <div class="form-group">
                        <label for="display-name">Your Username</label>
                        <input
                            type="text"
                            id="display-name"
                            placeholder="e.g., bob, sister1, uncle"
                            required
                            pattern="[a-zA-Z0-9_]+"
                        />
                        <small
                            style="
                                color: var(--gray-500);
                                margin-top: 4px;
                                display: block;
                            "
                            >Letters, numbers, and underscores only</small
                        >
                    </div>

                    <div class="button-group">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            onclick="showScreen('landing-screen')"
                        >
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Join
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Market Lobby Screen (Draft state) -->
        <div id="lobby-screen" class="screen">
            <div class="container">
                <div class="header-bar">
                    <div>
                        <h2 id="lobby-market-name">Market Name</h2>
                        <p class="status">
                            Status: <span id="lobby-status">Draft</span>
                        </p>
                    </div>
                    <div class="header-actions">
                        <button id="copy-invite-btn" class="btn btn-small">
                            Copy Invite
                        </button>
                    </div>
                </div>

                <div class="invite-code-display">
                    <span class="label">Invite Code:</span>
                    <span class="code" id="lobby-invite-code">ABC123</span>
                </div>

                <div class="section">
                    <h3>Players (<span id="player-count">0</span>)</h3>
                    <ul id="player-list" class="player-list"></ul>
                </div>

                <div
                    id="admin-controls"
                    class="admin-section"
                    style="display: none"
                >
                    <h3>Admin Controls</h3>
                    <button id="open-market-btn" class="btn btn-primary">
                        Open Market
                    </button>
                </div>
            </div>
        </div>

        <!-- Market Screen (Open/Active state) -->
        <div id="market-screen" class="screen">
            <div class="container">
                <div class="header-bar">
                    <div>
                        <div class="market-title">
                            <img src="logo.png" alt="" class="header-logo" />
                            <h2 id="market-name-display">Market Name</h2>
                        </div>
                        <p class="status">
                            Status: <span id="market-status">Open</span>
                        </p>
                        <p class="join-code-inline">
                            Join Code:
                            <span class="code-text" id="market-invite-code"
                                >ABC123</span
                            >
                            <button
                                id="copy-market-invite-btn"
                                class="copy-icon"
                                title="Copy invite code"
                            >
                                ðŸ“‹
                            </button>
                        </p>
                    </div>
                    <div class="user-info">
                        <span id="user-balance">$1000</span>
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab active" data-tab="bets">Bets</button>
                    <button class="tab" data-tab="feed">Feed</button>
                    <button class="tab" data-tab="leaderboard">
                        Leaderboard
                    </button>
                </div>

                <!-- Bets Tab -->
                <div id="bets-tab" class="tab-content active">
                    <div class="feed-ticker">
                        <div class="ticker-content" id="ticker-content"></div>
                    </div>

                    <div class="section">
                        <div class="section-header">
                            <h3>Active Bets</h3>
                            <button id="create-bet-btn" class="btn btn-small">
                                + Create Bet
                            </button>
                        </div>
                        <div id="bets-list" class="bets-list"></div>
                    </div>
                </div>

                <!-- Feed Tab -->
                <div id="feed-tab" class="tab-content">
                    <div class="section">
                        <h3>Activity Feed</h3>
                        <div id="feed-list" class="feed-list"></div>
                    </div>
                </div>

                <!-- Leaderboard Tab -->
                <div id="leaderboard-tab" class="tab-content">
                    <div class="section">
                        <h3>Rankings</h3>
                        <div id="leaderboard-list" class="leaderboard"></div>
                    </div>
                </div>

                <!-- Reveal Tab -->
                <div id="reveal-tab" class="tab-content">
                    <div class="section">
                        <h3>Bets About You</h3>
                        <p class="hint">
                            See what others are betting about you
                        </p>
                        <div id="reveal-list" class="bets-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Bet Modal -->
        <div id="create-bet-modal" class="modal">
            <div class="modal-content">
                <h3>Create Bet</h3>
                <form id="create-bet-form">
                    <div class="form-group">
                        <label for="bet-description">Bet Description</label>
                        <input
                            type="text"
                            id="bet-description"
                            placeholder="e.g., @bob will eat dessert first"
                            required
                        />
                        <small
                            style="
                                color: var(--gray-500);
                                margin-top: 4px;
                                display: block;
                            "
                            >Include @username to specify who the bet is
                            about</small
                        >
                    </div>

                    <div class="form-group">
                        <label for="opening-wager">Opening Wager</label>
                        <input
                            type="number"
                            id="opening-wager"
                            value="100"
                            min="1"
                            required
                        />
                    </div>

                    <div class="button-group">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            onclick="closeModal('create-bet-modal')"
                        >
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Create Bet
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Bet Detail Modal -->
        <div id="bet-detail-modal" class="modal">
            <div class="modal-content modal-large">
                <button
                    class="modal-close"
                    onclick="closeModal('bet-detail-modal')"
                >
                    Ã—
                </button>
                <h3 id="bet-detail-title">Bet Title</h3>
                <p id="bet-detail-description" class="hint"></p>

                <div class="bet-detail-graph">
                    <div class="probability-display">
                        <div class="probability-number" id="bet-detail-prob">
                            50%
                        </div>
                        <div class="probability-label">Probability YES</div>
                    </div>
                    <canvas
                        id="bet-detail-chart"
                        width="400"
                        height="200"
                    ></canvas>
                </div>

                <div class="bet-detail-pools">
                    <div class="pool-detail">
                        <div class="pool-detail-header">YES Pool</div>
                        <div
                            class="pool-detail-amount"
                            id="bet-detail-yes-pool"
                        >
                            $0
                        </div>
                    </div>
                    <div class="pool-detail">
                        <div class="pool-detail-header">NO Pool</div>
                        <div class="pool-detail-amount" id="bet-detail-no-pool">
                            $0
                        </div>
                    </div>
                </div>

                <div class="bet-detail-actions">
                    <button
                        class="btn btn-secondary"
                        onclick="openWagerModalFromDetail()"
                    >
                        Place Wager
                    </button>
                    <div id="bet-detail-admin-actions" style="display: none">
                        <button
                            class="btn btn-primary"
                            onclick="resolveBetFromDetail('YES')"
                        >
                            Resolve YES
                        </button>
                        <button
                            class="btn btn-primary"
                            onclick="resolveBetFromDetail('NO')"
                        >
                            Resolve NO
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Place Wager Modal -->
        <div id="wager-modal" class="modal">
            <div class="modal-content">
                <h3 id="wager-bet-title">Bet Title</h3>
                <p id="wager-bet-description" class="hint"></p>

                <form id="wager-form">
                    <div class="wager-pools">
                        <div class="pool">
                            <div class="pool-header">YES Pool</div>
                            <div class="pool-amount" id="wager-yes-pool">0</div>
                            <div class="pool-prob" id="wager-yes-prob">50%</div>
                        </div>
                        <div class="pool">
                            <div class="pool-header">NO Pool</div>
                            <div class="pool-amount" id="wager-no-pool">0</div>
                            <div class="pool-prob" id="wager-no-prob">50%</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Your Bet</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input
                                    type="radio"
                                    name="side"
                                    value="YES"
                                    required
                                />
                                <span>YES</span>
                            </label>
                            <label class="radio-label">
                                <input
                                    type="radio"
                                    name="side"
                                    value="NO"
                                    required
                                />
                                <span>NO</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="wager-amount">Amount</label>
                        <input
                            type="number"
                            id="wager-amount"
                            min="1"
                            required
                        />
                    </div>

                    <div class="button-group">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            onclick="closeModal('wager-modal')"
                        >
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Place Wager
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <script src="config.js"></script>
        <script src="app.js"></script>
    </body>
</html>
